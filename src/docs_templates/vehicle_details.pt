<tal:main_template define="main_template load: main_template.pt" metal:use-macro="main_template">
<div metal:fill-slot='body'>
    <div class="container">
        <h1>
            ${doc_helper.unpack_name_string(consist)}
            (${base_lang_strings[consist.str_name_suffix] if consist.str_name_suffix is not None else None})
        </h1>
        <div>
            <tal:livery repeat="livery_variant doc_helper.get_docs_livery_variants(consist)">
                <tal:block repeat="livery_name livery_variant.keys()">
                    <div class="vehicle-image"
                        style="width:${4 * doc_helper.buy_menu_sprite_max_width}; display:inline-block;">
                        <img src="static/img/${consist.id}_${livery_name}.png"
                             width="${4 * doc_helper.buy_menu_sprite_width(consist)}"
                             height="${4 * doc_helper.buy_menu_sprite_height}" />
                    </div>
                </tal:block>
            </tal:livery>
        </div>
        <dl>
            <dt>Role</dt>
            <dd>${doc_helper.unpack_role_string_for_consist(consist)}</dd>
            <dt>Intro date / Designed</dt>
            <dd>${consist.intro_date}</dd>
            <dt>Power</dt>
            <dd>${consist.power} hp</dd>
            <dt>Speed</dt>
            <dd>${consist.speed} mph</dd>
            <dt>Track type</dt>
            <dd>${consist.track_type}</dd>
        </dl>

        <dl>
            <dt>Replaces</dt>
            <tal:replaces condition="len(consist.replaces_consists) > 0">
                 <tal:replaced_consist repeat="replaced_consist consist.replaces_consists">
                    <dd>
                        <a href="${replaced_consist.id}.html">${doc_helper.get_replaced_by_name(replaced_consist.id, consists)}</a>
                    </dd>
                 </tal:replaced_consist>
            </tal:replaces>
            <tal:replaces_none condition="len(consist.replaces_consists) == 0">
                <dd>None</dd>
            </tal:replaces_none>

            <dt>Replaced by</dt>
            <tal:replacement condition="consist.replacement_consist is not None">
                <dd>
                    <a href="${consist.replacement_consist.id}.html">${doc_helper.get_replaced_by_name(consist.replacement_consist.id, consists)}</a>
                </dd>
            </tal:replacement>
            <tal:replacement_is_none condition="consist.replacement_consist is None">
                <dd>None</dd>
            </tal:replacement_is_none>

            <p>${structure:consist.description}</p>
        </dl>

        <table>
            <thead>
                <td><!--! empty spacer --></td>
                <tal:livery repeat="livery_variant doc_helper.get_docs_livery_variants(consist)">
                    <th style="padding:16px; text-align:left;">Livery ${repeat.livery_variant.number}</th>
                </tal:livery>
            </thead>
            <tbody>
                <tr style="vertical-align:top;">
                    <th style="padding:16px; text-align:right">Examples</th>
                    <tal:liveries repeat="livery_variant doc_helper.get_docs_livery_variants(consist)">
                        <td style="padding:16px;">
                            <tal:block repeat="livery_name livery_variant.keys()">
                                <div class="vehicle-image"
                                    style="width:${2 * doc_helper.buy_menu_sprite_max_width}; margin-bottom:16px;">
                                    <img src="static/img/${consist.id}_${livery_name}.png"
                                         width="${2 * doc_helper.buy_menu_sprite_width(consist)}"
                                         height="${2 * doc_helper.buy_menu_sprite_height}" />
                                </div>
                                <small>
                                    ${doc_helper.company_colour_names[livery_variant[livery_name]['docs_image_input_cc'][0]]}
                                    |
                                    ${doc_helper.company_colour_names[livery_variant[livery_name]['docs_image_input_cc'][1]]}
                                </small>
                            </tal:block>
                        </td>
                    </tal:liveries>
                </tr>
                <tr style="vertical-align:top;">
                    <th style="padding:16px; text-align:right">CC Rules</th>
                    <tal:liveries repeat="livery_variant doc_helper.get_docs_livery_variants(consist)">
                        <td style="padding:16px; width:${80/len(doc_helper.get_docs_livery_variants(consist))}%">
                            <tal:not_cc_livery condition="repeat.livery_variant.index == 0">
                                Shown if no other livery rules are matched.
                            </tal:not_cc_livery>
                            <tal:cc_livery condition="repeat.livery_variant.index != 0">
                                <tal:cc_livery_metadata define="cc_livery_metadata consist.gestalt_graphics.cc_liveries[repeat.livery_variant.index - 1]">
                                    Shown if CC1 is:
                                    <ul tal:repeat="cc1 cc_livery_metadata['cc1']">
                                        <li>${doc_helper.company_colour_names[cc1]}</li>
                                    </ul>
                                    <tal:block condition="len(cc_livery_metadata['not_cc2']) > 0">
                                        AND CC2 is not:
                                        <ul tal:repeat="not_cc2 cc_livery_metadata['not_cc2']">
                                            <li>${doc_helper.company_colour_names[not_cc2]}</li>
                                        </ul>
                                    </tal:block>
                                </tal:cc_livery_metadata>
                            </tal:cc_livery>
                        </td>
                    </tal:liveries>
                </tr>
            </tbody>
        </table>

    </div>
</div>
</tal:main_template>
